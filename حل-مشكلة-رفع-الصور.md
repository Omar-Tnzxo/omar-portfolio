# ๐ง ุญู ูุดููุฉ ุฑูุน ุงูุตูุฑ ูู ููุญุฉ ุงูุฅุฏุงุฑุฉ

## ุงููุดููุฉ
ุนูุฏ ูุญุงููุฉ ุฑูุน ุตูุฑุฉ ูู ููุญุฉ ุงูุฅุฏุงุฑุฉุ ูุธูุฑ ุฎุทุฃ:
```
StorageApiError: new row violates row-level security policy
```

## ุงูุณุจุจ
ุณูุงุณุงุช ุงูุฃูุงู (RLS Policies) ูู Supabase Storage ูู ูุชู ุฅุนุฏุงุฏูุง ุจุดูู ุตุญูุญ.

## ุงูุญู ุงูุณุฑูุน (5 ุฏูุงุฆู)

### ุงูุฎุทูุฉ 1: ุงูุชุญ Supabase Dashboard
1. ุงุฐูุจ ุฅูู: https://supabase.com/dashboard
2. ุงุฎุชุฑ ูุดุฑูุนู (omar-portfolio)

### ุงูุฎุทูุฉ 2: ุงูุชุญ SQL Editor
1. ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุถุบุท ุนูู **SQL Editor**
2. ุงุถุบุท **New query**

### ุงูุฎุทูุฉ 3: ููุฐ ุงูุณูุฑูุจุช
1. ุงูุชุญ ููู `supabase-storage-policies.sql` ูู ุงููุดุฑูุน
2. ุงูุณุฎ **ูู** ุงููุญุชูู
3. ุงูุตูู ูู SQL Editor
4. ุงุถุบุท **Run** (ุฃู Ctrl+Enter)
5. ุงูุชุธุฑ ุฑุณุงูุฉ ุงููุฌุงุญ "Success. No rows returned"

### ุงูุฎุทูุฉ 4: ุชุญูู ูู Storage Bucket
1. ุงุฐูุจ ุฅูู **Storage** ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
2. ุชุฃูุฏ ูู ูุฌูุฏ bucket ุงุณูู `portfolio-images`
3. ุฅุฐุง ูู ููู ููุฌูุฏุงู:
   - ุงุถุบุท **New bucket**
   - Name: `portfolio-images`
   - **ุชุฃูุฏ ูู ุชูุนูู**: Public bucket โ
   - ุงุถุบุท **Create bucket**

### ุงูุฎุทูุฉ 5: ุงุฎุชุจุงุฑ ุงูุฑูุน
1. ุงุฑุฌุน ูููููุน: http://localhost:5173/admin
2. ุณุฌู ุงูุฏุฎูู
3. ุงุฐูุจ ุฅูู **ุงููุดุงุฑูุน**
4. ุงุถุบุท **ุฅุถุงูุฉ ูุดุฑูุน ุฌุฏูุฏ**
5. ุฌุฑุจ ุฑูุน ุตูุฑุฉ
6. **ูุฌุจ ุฃู ูุนูู ุงูุขู! ๐**

## โ ุงูุชุญูู ูู ุงููุฌุงุญ

ุจุนุฏ ุชุทุจูู ุงูุญูุ ูุฌุจ ุฃู ุชุฑู:

1. โ ูุง ููุฌุฏ ุฎุทุฃ ุนูุฏ ุฑูุน ุงูุตูุฑุฉ
2. โ ุฑุณุงูุฉ "ุชู ุฑูุน ุงูุตูุฑุฉ ุจูุฌุงุญ"
3. โ ุงูุตูุฑุฉ ุชุธูุฑ ูู ูุนุงููุฉ ุงููููุฐุฌ
4. โ ุงูุตูุฑุฉ ููุฌูุฏุฉ ูู Storage Dashboard

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุง ูุฒุงู ุงูุฎุทุฃ ููุฌูุฏุงูุ

#### 1. ุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
- ุชุฃูุฏ ูู ุฃูู ูุณุฌู ุฏุฎูู ูู `/admin`
- ุงูุชุญ Console (F12) ูุชุญูู ูู ูุฌูุฏ session

#### 2. ุชุญูู ูู ุงูุณูุงุณุงุช
ููุฐ ูุฐุง ูู SQL Editor ููุชุญูู:
```sql
SELECT policyname, cmd 
FROM pg_policies 
WHERE tablename = 'objects' 
  AND policyname LIKE '%Allow%';
```
ูุฌุจ ุฃู ุชุฑู 4 ุณูุงุณุงุช:
- Allow public read access (SELECT)
- Allow authenticated uploads (INSERT)
- Allow authenticated updates (UPDATE)  
- Allow authenticated deletes (DELETE)

#### 3. ุชุญูู ูู ุงูู Bucket
```sql
SELECT * FROM storage.buckets WHERE name = 'portfolio-images';
```
ูุฌุจ ุฃู ููุฑุฌุน ุตู ูุงุญุฏ ูุน `public = true`

#### 4. ุงูุณุญ ุงูู Cache
- ูู ุงููุชุตูุญุ ุงุถุบุท Ctrl+Shift+Delete
- ุงูุณุญ Cached images and files
- ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ

#### 5. ุฃุนุฏ ุชุดุบูู ุงูุณูุฑูุฑ
```bash
# ุฃููู ุงูุณูุฑูุฑ (Ctrl+C)
npm run dev
```

## ุญุฌู ุงููููุงุช ุงููุณููุญ

- ุตูุฑุฉ ุงูุบูุงู: ุญุชู **10 MB**
- ุงูููุฏูู: ุญุชู **50 MB**
- ุตูุฑ ุงููุนุฑุถ: ุญุชู **10 MB** ููู ุตูุฑุฉ

## ุงูุตูุบ ุงููุฏุนููุฉ

- ุงูุตูุฑ: **JPG, PNG, WebP, GIF**
- ุงูููุฏูู: **MP4, WebM, MOV**

## ูุตุงุฆุญ ูููุฉ

1. **ุงุณุชุฎุฏู ุตูุบุฉ WebP** ููุตูุฑ - ุฃูุถู ุฌูุฏุฉ ูุญุฌู ุฃูู
2. **ุงุถุบุท ุงูุตูุฑ** ูุจู ุฑูุนูุง ุจุงุณุชุฎุฏุงู:
   - [TinyPNG](https://tinypng.com)
   - [Squoosh](https://squoosh.app)
3. **ุงุณุชุฎุฏู ุฃุณูุงุก ูุตููุฉ** ูููููุงุช
4. **ุชุฌูุจ ุงูุฃุญุฌุงู ุงูุถุฎูุฉ** - ููู ุงูุฏูุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑ

## ูุงุฐุง ูุญุฏุซ ุนูุฏ ุฑูุน ุตูุฑุฉุ

1. โ ุชูุฑูุน ุงูุตูุฑุฉ ุฅูู `portfolio-images/projects/`
2. โ ูุชู ุชูููุฏ ุงุณู ูุฑูุฏ: `timestamp-random.extension`
3. โ ููุญูุธ ุงูุฑุงุจุท ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
4. โ ุชุตุจุญ ุงูุตูุฑุฉ ูุชุงุญุฉ ููุนุฑุถ ููุฑุงู

## ุฑูุงุจุท ูููุฏุฉ

- [Supabase Storage Docs](https://supabase.com/docs/guides/storage)
- [Storage Security](https://supabase.com/docs/guides/storage/security/access-control)

---

## โก ุงูุญู ุงููุฎุชุตุฑ (ููุฎุจุฑุงุก)

```sql
-- ููุฐ ูู SQL Editor
DROP POLICY IF EXISTS "Allow public read access" ON storage.objects;
DROP POLICY IF EXISTS "Allow authenticated uploads" ON storage.objects;
DROP POLICY IF EXISTS "Allow authenticated updates" ON storage.objects;
DROP POLICY IF EXISTS "Allow authenticated deletes" ON storage.objects;

CREATE POLICY "Allow public read access" ON storage.objects FOR SELECT TO public USING (bucket_id = 'portfolio-images');
CREATE POLICY "Allow authenticated uploads" ON storage.objects FOR INSERT TO authenticated WITH CHECK (bucket_id = 'portfolio-images');
CREATE POLICY "Allow authenticated updates" ON storage.objects FOR UPDATE TO authenticated USING (bucket_id = 'portfolio-images');
CREATE POLICY "Allow authenticated deletes" ON storage.objects FOR DELETE TO authenticated USING (bucket_id = 'portfolio-images');
```

ุชุฃูุฏ ูู:
- โ Bucket ุงุณูู `portfolio-images` ููุฌูุฏ
- โ Bucket ุนุงู (Public = true)
- โ ุฃูุช ูุณุฌู ุฏุฎูู ูู `/admin`

---

**ุชู! ๐** ุงูุขู ููููู ุฑูุน ุงูุตูุฑ ุจุฏูู ูุดุงูู.

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ุชุฃูุฏ ูู:
1. Environment variables ุตุญูุญุฉ ูู `.env.local`
2. Supabase project ูุนูู ุจุดูู ุตุญูุญ
3. ูุฏูู ุงุชุตุงู ุจุงูุฅูุชุฑูุช
